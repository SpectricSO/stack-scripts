// ==UserScript==
// @name         Dark Mode 4 Chats - Stack Exchange - SpectricSO
// @namespace    https://github.com/SpectricSO/stack-scripts
// @version      2
// @description  Dark Mode for Stack Exchange Chats
// @author       SpectricSO
// @match        https://chat.stackoverflow.com/*
// @icon         https://www.google.com/s2/favicons?domain=stackoverflow.com
// @grant        none
// ==/UserScript==

!function(){"use strict";function t(){localStorage.setItem("darkmode4chats",JSON.stringify({bgprimary:"#393939",textprimary:"#ededed",outlineprimary:"#3d3d3d",textlink:"#acadac",textareabg:"#3e3e3e"}))}null==localStorage.getItem("darkmode4chats")&&t();var o=document.createElement("style");o.innerHTML='/** Dashboard Customizations **/\n    :root{\n        --bg-primary:#393939;\n        --text-primary:#ededed;\n        --outline-primary:#3d3d3d;\n        --text-link:#acadac;\n        --textarea-bg:#3e3e3e;\n    }\n    .fr a {\n        background-color: #2d2d2d;\n        color: white !important;\n        border: 1px solid;\n    }\n    .tabs a,.subtabs a{\n        color:white !important;\n    }\n    .nav ul li a{\n        color:white !important;\n    }\n    .ob-post-tag, .ob-user-tag {\n        color:black !important;\n    }\n    .room-mini, .roomcard, .usercard {\n        background-color:#3d3d3d !important;\n    }\n    .usercard-xxl, .roomcard-xxl {\n        background-color:var(--outline-primary) !important;\n    }\n    /** Chat Room customizations**/\n    body{\n        background-color:var(--bg-primary) !important;\n    }\n    html, body, ul, table, h1, h3, h4, section, hgroup, header, footer, nav, article, div, span, form, img, blockquote {\n        color:var(--text-primary) !important;\n    }\n    #sidebar #info #roomtitle{\n        text-shadow:0 1px 0px black !important;\n    }\n    .messages{\n        background-color:#2D2D2D !important;\n    }\n    #input-area{\n        background-color:#2D2D2D !important;\n        border-top:1px solid white;\n    }\n    .stars .img, #hlogo, #footer-logo, #transcript-logo{\n        filter:invert(.5) brightness(2);\n    }\n    #input{\n        background-color:var(--textarea-bg) !important;\n    }\n    a{\n        color: var(--text-link) !important;\n    }\n    #allrooms{\n        background-color:#2D2D2D !important;\n    }\n    .mention {\n        background-color: #efefef !important;\n        color: black !important;\n    }\n    .popup, #main.message-admin-mode .message-controls, #conversation-sel{\n        background-color:var(--bg-primary) !important;\n    }\n    .calendar{\n        color:black !important;\n    }\n    .popup .btn-close, #conversation-sel .btn-close{\n        color:black !important;\n    }\n    div.message .meta{\n        background-color:var(--outline-primary) !important;\n    }\n    a.button, button{\n        background-color:#2d2d2d !important;\n        color:black;\n    }\n    #chat-buttons button{\n        background-color:black !important;\n    }\n    #chat-buttons button.disabled{\n        background-color:#aaa !important;\n    }\n    .wmd-prompt-dialog {\n        background-color:var(--outline-primary) !important;\n    }\n    .wmd-mini-button{\n        background-color:black !important;\n    }\n    .monologue .timestamp{\n        background-color:var(--outline-primary) !important;\n    }\n    input ,textarea{\n        background-color:var(--outline-primary) !important;\n        color:var(--text-primary) !important;\n    }\n    .reply-parent *,.reply-child *{\n        color:black !important;\n    }\n    button, input[class="button"], a[class="button"] {\n        border: 1px solid !important;\n    }\n    .tag{\n        color:black !important;\n    }\n    .system-message-container .system-message{\n        background: linear-gradient(270deg, var(--outline-primary), white);\n    }\n    .highlight {\n        background-color: #878787 !important;\n    }\n    .ob-post{\n        background-color:var(--outline-primary) !important;\n    }',$(document.head).append(o);$(document.body).append('<style>.dark-mode-settings-modal *{color:#ededed !important;}.dark-mode-settings-modal{background-color:#3d3d3d !important;height: fit-content; width: 600px; position: fixed; left: calc((100% - 600px) / 2); top: 25%; background-color: var(--bg-primary); z-index: 100000; box-shadow: 0 0 3px white; border-radius: 5px; padding: 2em;}.dark-mode-settings-modal .dark-mode-options{margin-top:20px;}.dark-mode-settings-modal .dark-mode-option{display: flex; justify-content: space-between; margin: 10px 0px;}</style><div class="dark-mode-settings-modal"> <h1>Dark Mode for Chats</h1> <h3>By: <a href="https://stackoverflow.com/users/14251221/spectric">Spectric</a></h3> <div class="dark-mode-options"> <div class="dark-mode-option"> <p>Background: </p><input type="color" id="dark-mode-bg-primary"> </div><div class="dark-mode-option"> <p>Text Color (Primary): </p><input type="color" id="dark-mode-text-primary"> </div><div class="dark-mode-option"> <p>Outline Primary: </p><input type="color" id="dark-mode-outline-primary"> </div><div class="dark-mode-option"> <p>Text Color (Link): </p><input type="color" id="dark-mode-text-link"> </div><div class="dark-mode-option"> <p>Textarea Color: </p><input type="color" id="dark-mode-textarea-bg"> </div></div><b id="dark-mode-reset" style="cursor:pointer;text-decoration:underline">[Reset Preferences]</b></div>');var e=$(".dark-mode-settings-modal");function r(){var t=JSON.parse(localStorage.getItem("darkmode4chats"));$("#dark-mode-bg-primary").val(t.bgprimary),$("#dark-mode-textprimary").val(t.textprimary),$("#dark-mode-outline-primary").val(t.outlineprimary),$("#dark-mode-text-link").val(t.textlink),$("#dark-mode-textarea-bg").val(t.textareabg)}function n(){var t=JSON.parse(localStorage.getItem("darkmode4chats"));document.documentElement.style.setProperty("--bg-primary",t.bgprimary),document.documentElement.style.setProperty("--text-primary",t.textprimary),document.documentElement.style.setProperty("--outline-primary",t.outlineprimary),document.documentElement.style.setProperty("--text-link",t.textlink),document.documentElement.style.setProperty("--textarea-bg",t.textareabg)}e.hide(),n(),r(),$(document).ready(function(){$(".links-container").first().prepend('<span class="topbar-menu-links" style=""><a href="#" title="Dark Mode for Chats"><b>Dark Mode for Chats</b></a></span>');var o=document.createElement("link");o.setAttribute("href","https://fonts.googleapis.com/icon?family=Material+Icons"),o.setAttribute("rel","stylesheet"),$(document.head).append(o),$(document.body).append('<div class="dark-mode-settings" style="position: fixed;top: 50px;padding: 10px;background-color: black;border-radius: 0 50% 50% 0px;box-shadow: 0 0 3px white;text-align: right;cursor: pointer;user-select: none;z-index: 100000;"><span class="material-icons" style="vertical-align: middle;">settings</span></div>'),$(".dark-mode-settings").on("click",function(){e.toggle()}),$("input",e).on("input",function(){var t=$(this);!function(t,o){var e=JSON.parse(localStorage.getItem("darkmode4chats"));switch(t){case"dark-mode-bg-primary":e.bgprimary=o;break;case"dark-mode-text-primary":e.textprimary=o;break;case"dark-mode-outline-primary":e.outlineprimary=o;break;case"dark-mode-text-link":e.textlink=o;break;default:e.textareabg=o}localStorage.setItem("darkmode4chats",JSON.stringify(e)),n()}(t.attr("id"),t.val())}),$("#dark-mode-reset",e).on("click",function(){document.documentElement.style.removeProperty("--bg-primary"),document.documentElement.style.removeProperty("--text-primary"),document.documentElement.style.removeProperty("--outline-primary"),document.documentElement.style.removeProperty("--text-link"),document.documentElement.style.removeProperty("--textarea-bg"),t(),r()})})}();
